<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carica le tue foto üì∏</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Montserrat:wght@500;600&display=swap" rel="stylesheet">

  <!-- Cloudinary Upload Widget -->
  <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>

  <style>
    :root { --blue:#008CFF; --coral:#FF3B5B; }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:linear-gradient(135deg,#c2e9fb,#f9c2f9);
      display:grid; place-items:center;
    }
    .card{
      width:min(680px,92vw);
      background:#fff; border-radius:22px;
      padding:36px 28px;
      box-shadow:0 20px 50px rgba(0,0,0,.12);
      text-align:center;
    }
    h1{
      font-family:'Marcellus',serif;
      margin:0 0 8px; font-size:clamp(26px,4vw,36px);
    }
    p{color:#2b2b2b; margin:0 0 18px}
    .btn{
      display:inline-block; border:0; cursor:pointer;
      padding:12px 26px; border-radius:999px; color:#fff; font-weight:800;
      background:linear-gradient(90deg,var(--blue),var(--coral));
      box-shadow:0 12px 28px rgba(0,0,0,.18);
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .btn:hover{ transform:translateY(-2px); box-shadow:0 16px 34px rgba(0,0,0,.24); }
    .link{ display:inline-block; margin-top:14px; color:var(--blue); font-weight:800; text-decoration:none }
    .muted{ font-size:.92rem; color:#475569 }
  </style>
</head>
<body>
  <main class="card" aria-label="Carica foto">
    <h1>Carica le tue foto üì∏</h1>
    <p>Premi il bottone, scegli le foto dal telefono e inviale. Le immagini in HD andranno nell‚Äôalbum degli sposi.</p>

    <button id="uploadBtn" class="btn">Carica foto</button>
    <br />
    <a class="link" href="index.html">‚Üê Torna al sito</a>

    <p class="muted" style="margin-top:16px">
      Puoi selezionare pi√π file (max 50 MB ciascuno). Formati: JPG/PNG/HEIC/WEBP.
    </p>
  </main>

  <script>
    // Configura i TUOI dati Cloudinary
    const cloudName    = 'dmzv9mzpr';     // ‚Üê il tuo cloud name
    const uploadPreset = 'wedding-ec';    // ‚Üê il tuo preset UNSIGNED
    const targetFolder = 'wedding-ec';    // ‚Üê cartella di destinazione

    function ensureWidgetLoaded(){
      if (typeof window.cloudinary === 'undefined'){
        alert("Non riesco ad aprire il selettore foto.\nControlla che l'ad-blocker o la protezione del browser non blocchino contenuti di terze parti e riprova.");
        console.error('Cloudinary widget non disponibile.');
        return false;
      }
      return true;
    }

    document.getElementById('uploadBtn').addEventListener('click', function(){
      if (!ensureWidgetLoaded()) return;

      window.cloudinary.openUploadWidget({
        cloudName: cloudName,
        uploadPreset: uploadPreset,        // deve essere UNSIGNED + Enabled
        folder: targetFolder,              // cartella dove salvare le foto
        sources: ['local','camera'],
        multiple: true,
        maxFileSize: 50 * 1024 * 1024,     // 50MB per file
        clientAllowedFormats: ['jpg','jpeg','png','heic','webp'],
        showAdvancedOptions: false,
        showPoweredBy: false,
        cropping: false,
        defaultSource: 'local',
      }, (error, result) => {
        if (error){
          console.error('Cloudinary error:', error);
          alert('Si √® verificato un errore durante il caricamento. Riprova.');
          return;
        }

        // Per ogni file caricato con successo
        if (result && result.event === 'success') {
          console.log('‚úÖ Upload:', result.info.original_filename, result.info.secure_url);
        }

        // Quando la coda √® terminata (tutti i file processati)
        if (result && result.event === 'queues-end') {
          alert('Grazie! Le tue foto sono state caricate ‚úÖ');
          // Se vuoi tornare alla home automaticamente:
          // window.location.href = 'index.html';
        }
      });
    });
  </script>
</body>
</html>
